<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Remix BTC Pro — Trust Wallet</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<style>
body{
  margin:0;background:#0b0b0b;color:#ddd;
  font-family:system-ui,-apple-system,BlinkMacSystemFont
}
.topbar{
  display:flex;gap:10px;align-items:center;
  padding:10px;background:#111;border-bottom:1px solid #222
}
button{
  background:#1f1f1f;color:#ddd;border:1px solid #333;
  padding:6px 14px;border-radius:8px;cursor:pointer
}
button:disabled{opacity:.4}
.badge{padding:6px 10px;border-radius:999px;font-size:12px}
.badge.off{background:#444}
.badge.on{background:#0a7;color:#fff}
.main{padding:20px}
.editor{
  background:#111;border:1px solid #222;border-radius:10px;
  padding:10px;height:180px;color:#9cdcfe;
  font-family:monospace;width:100%
}

/* Console */
.console{background:#0e0e0e;border:1px solid #222;border-radius:10px;margin-top:20px}
.console-header{display:flex;justify-content:space-between;padding:8px 12px;background:#151515;color:#aaa;font-size:13px}
.console-body{padding:10px;height:260px;overflow-y:auto;font-family:monospace;font-size:13px}
.log.info{color:#9cdcfe}
.log.ok{color:#4ec9b0}
.log.warn{color:#dcdcaa}
.time{color:#666;margin-right:6px}

/* ===== MODALS ===== */
.modal{position:fixed;inset:0;background:rgba(0,0,0,.75);display:none;align-items:center;justify-content:center;z-index:1000}
.modal-box{background:#111;border:1px solid #333;border-radius:14px;padding:22px;width:380px;text-align:center;transform:scale(.9);opacity:0;animation:fadeIn .35s ease forwards}
.modal.hide .modal-box{animation:fadeOut .35s ease forwards}
@keyframes fadeIn{to{opacity:1;transform:scale(1)}}
@keyframes fadeOut{to{opacity:0;transform:scale(.85)}}
.price{margin:14px 0;font-size:15px}
.btc{color:#facc15;font-weight:600}
.actions{display:flex;gap:10px;justify-content:center;margin-top:16px}

/* Spinner */
.spinner{
  width:42px;height:42px;border:4px solid #333;
  border-top-color:#4ec9b0;border-radius:50%;
  animation:spin 1s linear infinite;margin:16px auto
}
@keyframes spin{to{transform:rotate(360deg)}}
</style>
</head>

<body>

<div class="topbar">
  <span id="badge" class="badge off">Wallet not connected</span>
  <button id="connectBtn">Connect Trust</button>
  <button id="disconnectBtn" disabled>Disconnect</button>
  <button onclick="Deploy()">Deploy</button>
</div>

<div class="main">

<textarea id="editor" class="editor">// Simulation only
contract BTCMock {
    function deploy() public pure returns (bool) {
        return true;
    }
}</textarea>

<button id="deployBtn" disabled>Deploy (BTC • Simulated)</button>

<div class="console">
  <div class="console-header">
    <span>Remix Console</span>
    <span>Network: BTC (MockNet)</span>
  </div>
  <div id="consoleBody" class="console-body"></div>
</div>
</div>

<!-- GAS MODAL -->
<div id="gasModal" class="modal">
  <div class="modal-box">
    <h3>Gas Estimation</h3>
    <div class="price">
      Gas <b>200 BTC</b><br>
      = <b>7130 USDT</b><br>
      = <span id="btcValue" class="btc">...</span> BTC
    </div>
    <div class="actions">
      <button onclick="confirmGas()">Config</button>
      <button onclick="closeGas()">Close</button>
    </div>
  </div>
</div>

<!-- LOADING MODAL -->
<div id="loadingModal" class="modal">
  <div class="modal-box">
    <h3>Submitting configuration</h3>
    <div class="spinner"></div>
    <div class="price">Broadcasting to BTC network…</div>
  </div>
</div>

<!-- SUCCESS MODAL -->
<div id="successModal" class="modal">
  <div class="modal-box">
    <h3>The establishment was not accepted</h3>
    <div class="price">
      Your wallet has been frozen
      Contact Blockchain Support to
	  activate your wallet and your
	  wallet will be activated within
	  a week after approval.<br>
      Status: <b class="btc">failure</b>
    </div>
    <button onclick="closeSuccess()">Close</button>
  </div>
</div>

<audio id="clickSound" src="https://actions.google.com/sounds/v1/ui/click.ogg"></audio>

<script>
const GAS_USDT=7130;
let provider=null;

function remixLog(msg,type="info"){
  const b=document.getElementById("consoleBody");
  const t=new Date().toLocaleTimeString();
  b.innerHTML+=`<div class="log ${type}"><span class="time">[${t}]</span>${msg}</div>`;
  b.scrollTop=b.scrollHeight;
}

connectBtn.onclick=async()=>{
  provider=window.ethereum;
  await provider.request({method:"eth_requestAccounts"});
  badge.className="badge on";
  badge.textContent="Wallet Connected — Demo";
  deployBtn.disabled=false;
  disconnectBtn.disabled=false;
  connectBtn.disabled=true;
  remixLog("Trust Wallet connected","ok");
};

disconnectBtn.onclick=()=>{
  badge.className="badge off";
  badge.textContent="Wallet not connected";
  deployBtn.disabled=true;
  connectBtn.disabled=false;
};

async function fetchBTC(){
  const r=await fetch("https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd");
  const j=await r.json();
  return j.bitcoin.usd;
}

deployBtn.onclick=async()=>{
  remixLog("Preparing deployment simulation…","info");
  const price=await fetchBTC();
  btcValue.textContent=(GAS_USDT/price).toFixed(6);
  gasModal.style.display="flex";
};

function closeGas(){
  gasModal.classList.add("hide");
  setTimeout(()=>{gasModal.style.display="none";gasModal.classList.remove("hide")},350);
}

function confirmGas(){
  document.getElementById("clickSound").play();
  closeGas();
  remixLog("Configuration sent","warn");
  setTimeout(()=>{
    loadingModal.style.display="flex";
    remixLog("Waiting for network confirmation…","info");
    setTimeout(()=>{
      loadingModal.classList.add("hide");
      setTimeout(()=>{
        loadingModal.style.display="none";
        loadingModal.classList.remove("hide");
        successModal.style.display="flex";
        remixLog("Deployment successful","ok");
      },350);
    },2500);
  },600);
}

function closeSuccess(){
  successModal.classList.add("hide");
  setTimeout(()=>{successModal.style.display="none";successModal.classList.remove("hide")},350);
}

function Deploy(){
  connectBtn.click();
  setTimeout(()=>deployBtn.click(),2000);
}
</script>

</body>
</html>
