<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Remix BTC Pro â€” Trust Wallet Demo</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- WalletConnect v2 (Fallback only) -->
<script src="https://unpkg.com/@walletconnect/ethereum-provider@2.11.1/dist/index.umd.js"></script>

<style>
body{
  margin:0;background:#0b0b0b;color:#ddd;
  font-family:system-ui,-apple-system,BlinkMacSystemFont
}
.topbar{
  display:flex;gap:10px;align-items:center;
  padding:10px;background:#111;border-bottom:1px solid #222
}
button,select{
  background:#1f1f1f;color:#ddd;border:1px solid #333;
  padding:6px 12px;border-radius:8px;cursor:pointer
}
button:disabled{opacity:.4;cursor:not-allowed}
.badge{
  padding:6px 10px;border-radius:999px;font-size:12px
}
.badge.off{background:#444}
.badge.on{background:#0a7;color:#fff}

.main{padding:20px}
.editor{
  background:#111;border:1px solid #222;border-radius:10px;
  padding:10px;height:180px;color:#9cdcfe;
  font-family:monospace;white-space:pre;
  width:100%;resize:vertical
}

.console{
  background:#0e0e0e;border:1px solid #222;
  border-radius:10px;margin-top:20px
}
.console-header{
  display:flex;justify-content:space-between;
  padding:8px 12px;background:#151515;color:#aaa;
  font-size:13px;border-bottom:1px solid #222
}
.console-body{
  padding:10px;height:260px;overflow-y:auto;
  font-family:monospace;font-size:13px
}
.log.info{color:#9cdcfe}
.log.ok{color:#4ec9b0}
.log.warn{color:#dcdcaa}
.log.err{color:#f44747}
.time{color:#666;margin-right:6px}
.net{color:#facc15}
.tag{
  border:1px solid #333;border-radius:6px;
  padding:2px 6px;font-size:11px;margin-left:6px;color:#999
}
</style>
</head>

<body>

<div class="topbar">
  <span id="badge" class="badge off">Wallet not connected</span>
  <button id="connectBtn">Connect Trust</button>
  <button id="disconnectBtn" disabled>Disconnect</button>

  <span class="tag">BTC â€¢ SIMULATION</span>

  <select id="scenario">
    <option value="cheap">Low Fee</option>
    <option value="normal">Normal</option>
    <option value="extreme">Extreme</option>
  </select>
</div>

<div class="main">

<textarea id="editor" class="editor">// Paste ANY fake source code here
// (Simulation only, no real compilation)

contract BTCMock {
    function deploy() public pure returns (bool) {
        return true;
    }
}</textarea>

<button id="deployBtn" disabled>
  Deploy (BTC â€¢ Simulated)
</button>

<div class="console">
  <div class="console-header">
    <span>Remix Console</span>
    <span class="net">
      Network: <b>BTC (MockNet)</b> <span class="tag">NO REAL TX</span>
    </span>
  </div>
  <div id="consoleBody" class="console-body"></div>
</div>

</div>

<script>
let provider = null;

function remixLog(msg,type="info"){
  const body=document.getElementById("consoleBody");
  const line=document.createElement("div");
  const t=new Date().toLocaleTimeString();
  line.className=`log ${type}`;
  line.innerHTML=`<span class="time">[${t}]</span>${msg}`;
  body.appendChild(line);
  body.scrollTop=body.scrollHeight;
}

function getMockCost(){
  const s=document.getElementById("scenario").value;
  if(s==="cheap") return {btc:"0.15",alt:"0.002"};
  if(s==="normal") return {btc:"2",alt:"0.032"};
  return {btc:"200",alt:"0.082"};
}

document.getElementById("connectBtn").onclick = async () => {
  try{
    /* âœ… PRIORITY: Trust Wallet Extension */
    if (window.ethereum && window.ethereum.isTrust) {
      provider = window.ethereum;
      await provider.request({ method: "eth_requestAccounts" });

      remixLog("Trust Wallet Extension connected","ok");
      remixLog("Injected provider detected","info");
    } 
    /* ðŸ” Fallback: WalletConnect QR */
    else {
      provider = await EthereumProvider.init({
        projectId: "demo-project-id",
        chains: [1],
        showQrModal: true
      });
      await provider.connect();
      remixLog("WalletConnect session started","warn");
    }

    remixLog("Transaction signing disabled","warn");

    badge.className="badge on";
    badge.innerText="Wallet Connected â€” Demo Mode";
    deployBtn.disabled=false;
    disconnectBtn.disabled=false;
    connectBtn.disabled=true;

  }catch(e){
    remixLog("Wallet connection failed","err");
    remixLog(e.message,"err");
  }
};

document.getElementById("disconnectBtn").onclick = async () => {
  if(provider?.disconnect) await provider.disconnect();
  remixLog("Wallet disconnected","err");

  badge.className="badge off";
  badge.innerText="Wallet not connected";
  deployBtn.disabled=true;
  disconnectBtn.disabled=true;
  connectBtn.disabled=false;
};

document.getElementById("deployBtn").onclick = () => {
  const code = document.getElementById("editor").value.trim();
  if(!code){
    remixLog("No source code detected","err");
    return;
  }

  const c=getMockCost();
  remixLog("Source code loaded","info");
  remixLog("Preparing deployment simulationâ€¦","info");

  setTimeout(()=>{
    remixLog(`Deployment cost: ${c.btc} BTC â‰ˆ 7000 USDT`,"warn");
    remixLog(`Alternative estimation: ${c.alt} BTC`,"warn");
    remixLog("No transaction executed â€” Simulation only","ok");
  },800);
};
</script>

</body>
</html>
